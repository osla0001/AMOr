---
import Layout from "../layouts/Layout.astro";
---

<Layout title="AMOr - Contact">
  <main>
    <div class="container">
      <h1>Kontakt os</h1>
      <p>Har du spørgsmål eller brug for hjælp? Send os en besked!</p>

      <form action="/api/support" method="POST" id="contactForm">
        <div class="form-group">
          <label for="name">Dit navn</label>
          <input
            type="text"
            id="name"
            name="name"
            placeholder="Dit navn"
            required
          />
        </div>

        <div class="form-group">
          <label for="email">Din email</label>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="Din email"
            required
          />
        </div>

        <div class="form-group">
          <label for="message">Din besked</label>
          <textarea
            id="message"
            name="message"
            placeholder="Skriv din besked her..."
            rows="5"
            required></textarea>
        </div>

        <button type="submit">Send besked</button>
      </form>

      <div id="response" class="response-message"></div>
    </div>
  </main>
</Layout>

<style>
  main {
    padding: 2rem;
    max-width: 600px;
    margin: 0 auto;
  }

  .container {
    width: 100%;
  }

  h1 {
    margin-bottom: 1rem;
  }

  p {
    margin-bottom: 2rem;
    color: #666;
  }

  form {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  label {
    font-weight: 600;
    color: #333;
  }

  input,
  textarea {
    padding: 0.75rem;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
    font-family: inherit;
    transition: border-color 0.3s ease;
  }

  input:focus,
  textarea:focus {
    outline: none;
    border-color: #0066cc;
  }

  textarea {
    resize: vertical;
  }

  button {
    padding: 1rem 2rem;
    background-color: #0066cc;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  button:hover {
    background-color: #0052a3;
  }

  button:disabled {
    background-color: #ccc;
    cursor: not-allowed;
  }

  .response-message {
    margin-top: 1rem;
    padding: 1rem;
    border-radius: 8px;
    display: none;
  }

  .response-message.success {
    display: block;
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }

  .response-message.error {
    display: block;
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }
</style>

<script>
  const form = document.getElementById("contactForm") as HTMLFormElement;
  const responseDiv = document.getElementById("response") as HTMLDivElement;

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const formData = new FormData(form);
    const button = form.querySelector("button") as HTMLButtonElement;

    // Disable button during submission
    button.disabled = true;
    button.textContent = "Sender...";

    try {
      const response = await fetch("/api/support", {
        method: "POST",
        body: formData,
      });

      if (response.ok) {
        responseDiv.className = "response-message success";
        responseDiv.textContent =
          "Din besked er sendt! Vi vender tilbage hurtigst muligt.";
        form.reset();
      } else {
        throw new Error("Fejl ved afsendelse");
      }
    } catch (error) {
      responseDiv.className = "response-message error";
      responseDiv.textContent =
        "Der opstod en fejl. Prøv venligst igen senere.";
    } finally {
      button.disabled = false;
      button.textContent = "Send besked";
    }
  });
</script>
